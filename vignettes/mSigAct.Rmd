---
title: "Introduction to mSigAct"
author: "Steven G. Rozen"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Background

'mSigAct' stands for **m**tational **Sig**nature
**Act**ivity. 
mSigAct can estimate (conservatively) whether there is evidence
    that a particular mutational signature is present in a spectrum and can
    determine a minimal subset of signatures needed to plausibly reconstruct an
    observed spectrum.
    
The concepts behind mSigAct
are described in Ng et al., 2017, "Aristolochic acids and their derivatives are widely 
implicated in liver cancers in Taiwan and throughout Asia", Science Translational Medicine 2017
<https://doi.org/10.1126/scitranslmed.aan6446>. 

## The SparseAssignSignature function

We show how to run `SparseAssignSignature` on a demo 
mutational spectrum data 
set (`mSigAct::BTSG.WGS.PCAWG`)
that is provided with the package. For functions for reading
mutation spectra or signatures from files, see 
[ICAMS](https://github.com/steverozen/ICAMS/).

```{r}
library(mSigAct)

estimated.exposure <- 
  SparseAssignActivity(mSigAct::BTSG.WGS.PCAWG[ , 1:3],
                       sigs=mSigAct::sp.sigs[ ,c("SBS1", "SBS5")])

estimated.exposure
```



Need to document basic concepts.

Describe concept of available signatures, and where to find 
which ones have been observed where. As Wu Yan to provide the appropriate
data.

Show how to assign exposures. Note that currently only works on one
cancer type at a time.
